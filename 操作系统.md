#### 操作系统在进行线程切换时需要进行哪些动作？

在操作系统中，线程切换是指将CPU的控制权从一个线程转移到另一个线程的过程，与进程切换相比，线程切换开销较小，因为同一进程内的线程共享相同的地址空间和资源。

主要动作如下：

1. 保存当前线程的上下文到线程控制块中
2. 更新当前线程的状态
3. 选择下一个要执行的线程，更新调度信息
4. 恢复下一个线程的上下文，恢复CPU寄存器、栈指针、程序计数器等信息，确保线程能够从上次中断的地方继续执行，开始执行其任务。

**线程上下文：**

主要涉及下面三个部分：

1. CPU寄存器：如程序计数器、栈指针、通用寄存器。这些值需要被保存，以便下次切换回当前线程时能够恢复。
2. 程序状态字（PSW）： 包括CPU的状态信息，比如中断使能，优先级等。
3. 线程的内核栈和用户栈：分别用于存储内核和用户空间的函数调用信息。

**线程控制块：**

包含了线程执行相关的所有必要信息，确保线程能够在系统中被正确调度和执行。

线程状态、程序计数器、寄存器内容、线程栈指针、线程优先级、线程标识符、线程的调度信息。

#### 什么是用户态和内核态

内核态（Kernel Mode）：在内核态下，CPU可以执行所有的指令和访问所有的硬件资源。这种模式下的操作具有更高的权限，主要用于操作系统内核的运行。

用户态（User Mode）：在用户态下，CPU只能执行部分指令集，无法直接访问硬件资源。这种模式下的操作权限较低，主要用于运行用户程序。

分为内核态和用户态的原因主要有以下几点：

安全性：通过对权限的划分，用户程序无法直接访问硬件资源，从而避免了恶意程序对系统资源的破坏。

稳定性：用户态程序出现问题时，不会影响到整个系统，避免了程序故障导致系统崩溃的风险。

隔离性：内核态和用户态的划分使得操作系统内核与用户程序之间有了明确的边界，有利于系统的模块化和维护。

#### 进程间通讯有哪些方式？

1. 有名管道：用于在父子进程之间通信，半双工的，从一端写入另一端读取。
2. 匿名管道：用于同一主机的不同进程之间通
3. 消息队列：允许一个进程向另一个进程发送消息，消息在队列中按顺序存放，并且接收方可以按序接受。
4. 共享内存：共享内存可以允许多个进程访问同一块内存区域，从来实现数据的交换，涉及到同步问题。
5. 信号量：信号量是一种同步原语，用于管理共享资源的访问。
6. 信号：信号是一种异步的通信方式，用于通知目标进程发生了某个事件。
7. 套接字：套接字允许在网络上的不同主机上的进程进行通信。

#### 操作系统中的进程有哪几种状态？

- *NULL -> 创建状态*：一个新进程被创建时的第一个状态；
- *创建状态 -> 就绪状态*：当进程被创建完成并初始化后，一切就绪准备运行时，变为就绪状态，这个过程是很快的；
- *就绪态 -> 运行状态*：处于就绪状态的进程被操作系统的进程调度器选中后，就分配给 CPU 正式运行该进程；
- *运行状态 -> 结束状态*：当进程已经运行完成或出错时，会被操作系统作结束状态处理；
- *运行状态 -> 就绪状态*：处于运行状态的进程在运行过程中，由于分配给它的运行时间片用完，操作系统会把该进程变为就绪态，接着从就绪态选中另外一个进程运行；
- *运行状态 -> 阻塞状态*：当进程请求某个事件且必须等待时，例如请求 I/O 事件
- *阻塞状态 -> 就绪状态*：当进程要等待的事件完成时，它从阻塞状态变到就绪状态；

#### 进程的调度算法你知道吗？

先来先服务调度算法：每次从就绪队列选择最先进入队列的进程，然后一直运行，直到进程退出或被阻塞，才会继续从队列中选择第一个进程接着运行。对短作业不利

最短作业优先调度算法：**优先选择运行时间最短的进程来运行**，这有助于提高系统的吞吐量。对长作业不利

高响应比优先调度算法：**每次进行进程调度时，先计算「响应比优先级」，然后把「响应比优先级」最高的进程投入运行**，「响应比优先级」的计算公式：

​									优先级 = （等待时间+要求服务时间）/ 要求服务时间

时间片轮转调度算法： **每个进程被分配一个时间段，称为时间片（Quantum)，即允许该进程在该时间段中运行。**如果时间片用完，进程还在运行，那么将会把此进程从 CPU 释放出来，并把 CPU 分配另外一个进程； 如果该进程在时间片结束前阻塞或结束，则 CPU 立即进行切换。

最高优先级调度算法： 对于多用户计算机系统就有不同的看法了，它们希望调度是有优先级的，即希望调度程序能**从就绪队列中选择最高优先级的进程进行运行**

多级反馈队列调度算法：通过将进程放入不同的优先级队列，实现灵活的调度机制。优先级高的进程先被调度，随着执行时间的增加，进程可能被降至低优先级队列。

#### 线程和进程的区别是什么？

**本质区别**：进程是操作系统资源分配的基本单位，而线程是任务调度和执行的基本单位

**在开销方面**：每个进程都有独立的代码和数据空间（程序上下文），程序之间的切换会有较大的开销；线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的运行栈和程序计数器（PC），线程之间切换的开销小

**稳定性方面**：进程中某个线程如果崩溃了，可能会导致整个进程都崩溃。而进程中的子进程崩溃，并不会影响其他进程。

**内存分配方面**：系统在运行的时候会为每个进程分配不同的内存空间；而对线程而言，除了CPU外，系统不会为线程分配内存（线程所使用的资源来自其所属进程的资源），线程组之间只能共享资源。

#### 什么是软中断，什么是硬中断？

中断是**CPU停下当前的工作任务，去处理其他事情，处理完后回来继续执行刚才的任务**。

硬中断：是由硬件设备触发的中断信号。当硬件设备需要与CPU交互，会通过硬中断通知CPU。硬中断具有高优先级，通常会立即打断当前执行的程序，进行中断处理。

软中断：是由软件触发的中断，通过是通过执行特定的指令或系统调用产生的。软中断用于在程序运行中请求操作系统的服务，如文件读、进程调度等。

#### 为什么要有虚拟内存？

虚拟内存：是操作系统提供给每个运行中程序的一种地址空间，每个程序在运行时认为自己拥有的内存空间就是虚拟内存，其大小可以远远大于物理内存的大小。虚拟内存通过将程序的地址空间划分成若干个固定大小的页或段，并将这些页或者段映射到物理内存中的不同位置，从而使得程序在运行时可以更高效地利用物理内存。

主要作用是提升系统效率和简化内存管理。

**内存扩展能力：**

虚拟内存允许程序运行在比实际物理内存大的地址空间上。即时物理内存不足，系统也可以通过交换将不常用的内存页移到磁盘中，使得多个程序能够同时运行。

**进程隔离：**

每个进程拥有独立的虚拟地址空间，防止进程间的内存访问冲突，提高系统稳定性和安全性。

**简化内存管理：**

操作系统可以更灵活地分配和回收内存，无需手动考虑物理内存布局问题。

#### 什么是分段，什么是分页？

分段和分页是操作系统中用于内存管理的两种方式，目的是提高内存利用率并简化程序的管理。

**分段：**

是一种根据程序逻辑结构划分内存的方式，例如将程序分为若干个段（代码段、数据段、堆栈段），每个段有独立的段号和段内偏移。

每个段可以有不同的大小，段的长度取决于程序的实际需求，段与段之间可能不连续。

分段管理提供了一种更贴近程序结构的内存管理方式，有助于提高程序的可读性和维护性。

优点：与程序员的逻辑结构一致，便于编译器和程序员理解；每个段可以独立增长，不会影响其他段的大小。支持动态内存分配，数据段可以在运行时增大。 

缺点：容易产生外部碎片，段表的管理和维护比较复杂。

**分页：**

是一种将物理内存和逻辑内存划分为固定大小的页和页框的方法，每个页和页框大小相同。

逻辑地址空间被划分为若干个固定大小的页，物理内存则被划分为相同大小的页框，页通过页表映射到页框。

分页管理解决了内存碎片的问题，但程序的逻辑结构和内存的物理结构不一致。

优点：解决外部碎片的问题，内存管理灵活，可以将不常用的页交换到磁盘上，扩大内存空间

缺点：内部碎片，如果程序使用的内存量不足一个页的大小，会造成页内未使用部分的浪费。

​			页表管理开销大，，每个进程都需要维护自己的页表。

#### CPU使用率和CPU负载指的是什么？

CPU使用率：是指在特定时间窗口内，CPU用于处理任务的时间百分比。

CPU负载： 表示系统中需要被CPU处理的任务数量。

CPU使用率反应CPU的忙碌程度。 CPU负载反应等待处理的任务数量。

#### I/O是什么？

![1739881753566](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881753566.png)

#### 为什么网络I/O会被阻塞？

![1739881787175](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881787175.png)

#### I/O模型有哪些？

![1739881822636](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881822636.png)

#### 同步异步的区别？

![1739881840531](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881840531.png)

#### 阻塞和非阻塞的区别？

![1739881858461](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881858461.png)

#### 什么是Reactor？

![1739881885241](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881885241.png)

![1739881905285](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881905285.png)

![1739881914283](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881914283.png)

#### Select、poll、epoll之间区别？

![1739881961107](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881961107.png)

![1739881990921](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739881990921.png)

#### 什么是物理地址，什么是逻辑地址？

![1739882021779](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739882021779.png)

![1739882032509](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739882032509.png)

#### 听说过CFS吗？

![1739882053881](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739882053881.png)

#### 负数的二进制如何表示？

![1739882074072](C:\Users\renyu\AppData\Roaming\Typora\typora-user-images\1739882074072.png)

